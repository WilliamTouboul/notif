<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            width: 100vw;
        }
    </style>
</head>

<body>
    <button id="button">CLICK ME</button>
    <a href="phone.html">phone</a>


    <script>
        const button = document.querySelector('#button');

        button.addEventListener('click', function () {
            Notification.requestPermission().then(perm => {
                if (perm === "granted") {
                    const my_notification = new Notification('Test Notification', {
                        body: 'Ceci est une notification',
                        data: {
                            hello: "world"
                        },
                        icon: "star.png",
                        tag: 'welcome message', // ID unique a cette notif, overwrite si plusieurs ont le meme nom
                        vibrate: true
                    });



                    my_notification.addEventListener('show', e => {
                        console.log(e);
                        //Event a l'apparition de la notif
                    });

                    my_notification.addEventListener('close', e => {
                        console.log('close');
                        // Event a la fermutre de la notif
                    });

                    my_notification.addEventListener('error', e => {
                        console.log('error');
                        // Fonctionne aussi sur l'utilisateur a bloquÃ© les notifs
                    });
                }
            })
        });

        // Des que la page n'est plus visible lance une notif qui s'actualise toutes les secondes.7


        // Commenter le temps de tester sur tel 

        // document.addEventListener('visibilitychange', () => {
        //     if (document.visibilityState === "hidden") {
        //         const leaveDate = new Date();
        //         setInterval(() => {
        //             let leave_notif = new Notification('come back please', {
        //                 body: `PLEAAAAASE, youve been gone for ${Math.round((new Date() - leaveDate) / 1000)}`,
        //                 tag: 'come back'
        //             }, 100)
        //         })

        //     }
        // })
    </script>
</body>

</html>